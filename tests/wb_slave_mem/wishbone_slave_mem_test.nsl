#include "wishbone_master.h"
#include "wishbone_common.h"
#include "wishbone_syscon.h"
#include "ram64x8K.h"


declare wishbone_slave_mem_test simulation {
	WISHBONE_MASTER_ACCESS_IN_PORTS(32, 64, 8)
}

module wishbone_slave_mem_test {
	wishbone_syscon wb_syscon;
	wishbone_master wb_master0;
	ram64x8K wb_slave0;
	reg r = 0;
	
	wb_syscon.CLK_I = m_clock;
	wb_syscon.RST_I = p_reset;
	WISHBONE_P2P(wb_master0, wb_slave0, wb_syscon);

	if(~r) {
		wb_slave0.reset();
		r := ~r;
	}

	func req_read {
		wb_master0.req_read(req_addr, req_sel);
	}
	func req_write {
		wb_master0.req_write(req_addr, req_sel, req_data);
	}
	func req_read_modify_write {
		wb_master0.req_read_modify_write(req_addr, req_sel, req_data);
	}
	func wb_master0.req_stall {
		req_stall();
	}
	func wb_master0.rsp_valid {
		rsp_valid(wb_master0.rsp_data);
	}
	func wb_master0.rsp_error {
		rsp_error();
	}
	func wb_master0.rsp_retry {
		rsp_error();
	}
	func wb_master0.rsp_stall {
		rsp_error();
	}
}
